(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{28:(e,s,n)=>{"use strict";n.d(s,{t:()=>t});let t="http://localhost:3000"},167:(e,s,n)=>{"use strict";n.d(s,{A:()=>i});var t=n(5155),a=n(2619),r=n.n(a),l=n(63),o=n(2115);n(1554);let i=function(){let[e,s]=(0,o.useState)(()=>localStorage.getItem("theme")||"dark"),[n,a]=(0,o.useState)("light"===e?"LocShare":"AnonShare"),i=(0,l.useRouter)();return(0,o.useEffect)(()=>{a("light"===e?"LocShare":"AnonShare"),document.body.className=e,localStorage.setItem("theme",e)},[e]),(0,t.jsx)("header",{className:"header",children:(0,t.jsxs)("div",{className:"container header-container",children:[(0,t.jsx)(r(),{href:"/",className:"logo",onDoubleClick:()=>{"dark"===e?(s("light"),a("LocShare")):(s("dark"),a("AnonShare"))},children:n}),(0,t.jsxs)("div",{className:"header-buttons",children:[(0,t.jsx)("button",{className:"header-btn",onClick:s=>{s.preventDefault(),"light"===e?i.push("/locshare"):i.push("/share")},children:"Send Securely"}),(0,t.jsx)("button",{className:"header-btn light",onClick:e=>{e.preventDefault(),i.push("/access")},children:"Safely Access Files"})]})]})})}},1554:()=>{},1847:(e,s,n)=>{"use strict";n.d(s,{A:()=>i});var t=n(2115);let a=e=>{let s=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,n)=>n?n.toUpperCase():s.toLowerCase());return s.charAt(0).toUpperCase()+s.slice(1)},r=function(){for(var e=arguments.length,s=Array(e),n=0;n<e;n++)s[n]=arguments[n];return s.filter((e,s,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===s).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,t.forwardRef)((e,s)=>{let{color:n="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:h,...u}=e;return(0,t.createElement)("svg",{ref:s,...l,width:a,height:a,stroke:n,strokeWidth:i?24*Number(o)/Number(a):o,className:r("lucide",c),...u},[...h.map(e=>{let[s,n]=e;return(0,t.createElement)(s,n)}),...Array.isArray(d)?d:[d]])}),i=(e,s)=>{let n=(0,t.forwardRef)((n,l)=>{let{className:i,...c}=n;return(0,t.createElement)(o,{ref:l,iconNode:s,className:r("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...c})});return n.displayName=a(e),n}},1965:(e,s,n)=>{"use strict";n.d(s,{A:()=>a});var t=n(5155);n(3448);let a=function(){return(0,t.jsx)("footer",{className:"footer",children:(0,t.jsxs)("div",{className:"container",children:[(0,t.jsxs)("div",{className:"footer-content",children:[(0,t.jsxs)("div",{className:"footer-logo-section",children:[(0,t.jsx)("div",{className:"footer-logo",children:"AnonShare"}),(0,t.jsx)("p",{className:"footer-tagline",children:"Stay Connected with Us"})]}),(0,t.jsxs)("div",{className:"footer-links",children:[(0,t.jsxs)("div",{className:"footer-column",children:[(0,t.jsx)("h3",{children:"LINKS"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",children:"Privacy Policy"})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",children:"Terms of Use"})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",children:"Support Center"})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",children:"Feedback"})})]})]}),(0,t.jsxs)("div",{className:"footer-column",children:[(0,t.jsx)("h3",{children:"RESOURCES"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",children:"Contact Us"})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",children:"About Us"})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",children:"Latest Updates"})})]})]})]})]}),(0,t.jsxs)("div",{className:"footer-bottom",children:[(0,t.jsx)("p",{className:"copyright",children:"\xa9 Copyright 2025"}),(0,t.jsxs)("div",{className:"subscribe",children:[(0,t.jsx)("input",{type:"email",placeholder:"Email"}),(0,t.jsx)("button",{children:"Subscribe"})]})]})]})})}},2056:(e,s,n)=>{"use strict";n.d(s,{A:()=>t});let t=(0,n(1847).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3448:()=>{},5044:()=>{},5426:(e,s,n)=>{"use strict";n.d(s,{A:()=>t});let t=(0,n(1847).A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},8421:(e,s,n)=>{"use strict";n.d(s,{G7:()=>o,Gi:()=>a,PE:()=>l,Pd:()=>c,RY:()=>r,Yn:()=>h,v:()=>u,vR:()=>i,zW:()=>d});var t=n(28);let a=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3600,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=new FormData;return e&&l.append("file",e),r&&l.append("encryptedText",r),l.append("expireSeconds",s),n&&l.append("password",n),a&&l.append("maxDownloads",a),(await fetch("".concat(t.t,"/upload"),{method:"POST",body:l})).json()},r=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=s?"?password=".concat(encodeURIComponent(s)):"",a=await fetch("".concat(t.t,"/session-info/").concat(e).concat(n));if(!a.ok)throw Error("Session not found");return a.json()},l=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=s?"?password=".concat(encodeURIComponent(s)):"";window.location.href="".concat(t.t,"/download/").concat(e).concat(n)},o=async e=>(await fetch("".concat(t.t,"/endsession"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ownerToken:e})})).json(),i=async e=>{let s=await fetch("".concat(t.t,"/session-data/").concat(e));if(!s.ok)throw Error("Session not found or unauthorized");return s.json()},c=async function(e,s){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=new FormData;e&&l.append("file",e),r&&l.append("encryptedText",r),l.append("port",s),n&&l.append("password",n),a&&l.append("maxDownloads",a);let o=await fetch("".concat(t.t,"/local-server/start"),{method:"POST",body:l});if(!o.ok)throw Error((await o.json()).error||"Failed to start local server");return o.json()},d=async e=>{let s=await fetch("".concat(t.t,"/local-server/stop"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({port:e})});if(!s.ok)throw Error((await s.json()).error||"Failed to stop local server");return s.json()},h=async e=>(await fetch("".concat(t.t,"/local-server/check-port/").concat(e))).json(),u=async e=>{let s=await fetch("".concat(t.t,"/local-server/stats/").concat(e));if(!s.ok)throw Error("Failed to get server stats");return s.json()}},8634:(e,s,n)=>{Promise.resolve().then(n.bind(n,8770))},8770:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>f});var t=n(5155),a=n(2115);n(2834);var r=n(63),l=n(5239),o=n(167),i=n(1965),c=n(2056),d=n(6983),h=n(1847);let u=(0,h.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var x=n(5426);let m=(0,h.A)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),p=(0,h.A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);n(5044);var j=n(8421);function f(){var e;let s=(0,r.useParams)().ownerToken,n=(0,r.useRouter)(),[h,f]=(0,a.useState)(null),[v,g]=(0,a.useState)(!1),[w,y]=(0,a.useState)(null),[N,S]=(0,a.useState)(!1),[k,C]=(0,a.useState)(null),[A,b]=(0,a.useState)(!1),[z,E]=(0,a.useState)(!1),I=(0,a.useRef)(null),T=(0,a.useRef)(null);(0,a.useEffect)(()=>{"light"===(localStorage.getItem("theme")||"dark")&&n.push("/");let e=setInterval(()=>{"light"===(localStorage.getItem("theme")||"dark")&&n.push("/")},100);return()=>clearInterval(e)},[n]),(0,a.useEffect)(()=>{(async()=>{try{if(!s){C("Unauthorized access - owner token required"),b(!0);return}let e=await (0,j.vR)(s);e?y(e):(C("Session not found or unauthorized"),E(!0),f(0))}catch(e){console.error("Failed to load session data:",e),C("Session not found or unauthorized access"),E(!0),f(0)}finally{b(!0)}})();let e=setInterval(async()=>{if(s&&!z&&!k)try{let e=await (0,j.vR)(s);e&&y(s=>({...s,downloads:e.downloads,maxDownloads:e.maxDownloads}))}catch(s){console.error("Failed to poll session data:",s),C("Session has been cancelled or expired"),E(!0),f(0),clearInterval(e)}},3e3);return()=>{clearInterval(I.current),clearInterval(e),clearTimeout(T.current)}},[s,z,k]),(0,a.useEffect)(()=>{if(!A||k||z||!w||!w.expiresAt){!A||z||k||!w||w.expiresAt||(console.log("Session loaded but has no expiry date. Setting timeRemaining to 0."),f(0));return}let e=Math.max(0,Math.floor((new Date(w.expiresAt).getTime()-Date.now())/1e3));f(e),clearInterval(I.current),clearTimeout(T.current),e>0?(I.current=setInterval(()=>{f(e=>null===e||e<=1?(clearInterval(I.current),0):e-1)},1e3),z||(S(!0),T.current=setTimeout(()=>{S(!1)},5e3))):(console.log("Timer Effect: Initial time is zero or negative. Not starting interval."),f(0))},[w,A,z,k]);let R=async()=>{if(!window.confirm("Are you sure you want to cancel this sharing session? This action cannot be undone."))return void console.log("[Cancel] Aborted by user.");if(console.log("[Cancel] Confirmed by user. Current state:",{sessionCancelled:z,timeRemaining:h}),console.log("[Cancel] Clearing timer interval."),clearInterval(I.current),!s){console.error("[Cancel] Cannot proceed: owner token is missing."),alert("Error: Unauthorized access. Cannot cancel session.");return}console.log("[Cancel] Attempting to call endSharingSession API for owner token: ".concat(s));try{await (0,j.G7)(s),console.log("[Cancel] API call for owner token ".concat(s," successful.")),console.log("[Cancel] Setting sessionCancelled = true and timeRemaining = 0"),E(!0),f(0)}catch(e){console.error("[Cancel] API call failed for owner token ".concat(s,":"),e),alert("Failed to cancel the session on the server. It might expire automatically later. Cancelling the view locally."),console.log("[Cancel] API failed, but setting sessionCancelled = true and timeRemaining = 0 for UI"),E(!0),f(0)}},U=A&&0===h,D=A&&(k||!w&&!z),F=z||U;if(D)return(0,t.jsxs)("div",{className:"session-page",children:[(0,t.jsx)(o.A,{}),(0,t.jsx)("main",{className:"session-container",children:(0,t.jsx)("div",{className:"session-card",children:(0,t.jsxs)("div",{className:"session-cancelled",children:[(0,t.jsx)(c.A,{size:60,className:"cancelled-icon"}),(0,t.jsx)("h1",{children:"Unauthorized Access"}),(0,t.jsx)("p",{children:k||"This session is not accessible. Only the person who created the share can view this page."}),(0,t.jsx)("a",{href:"/share",className:"new-share-btn",children:"Start a New Share"})]})})}),(0,t.jsx)(i.A,{})]});if(F){let e=z?"Cancelled":"Expired",s=z?"You have cancelled it.":"The time limit has been reached.";return(0,t.jsxs)("div",{className:"session-page",children:[(0,t.jsx)(o.A,{}),(0,t.jsx)("main",{className:"session-container",children:(0,t.jsx)("div",{className:"session-card",children:(0,t.jsxs)("div",{className:"session-cancelled",children:[(0,t.jsx)(c.A,{size:60,className:"cancelled-icon"}),(0,t.jsxs)("h1",{children:["Session ",e]}),(0,t.jsxs)("p",{children:["This file sharing session is no longer available."," ",s]}),(0,t.jsx)("a",{href:"/share",className:"new-share-btn",children:"Share New Files"})]})})}),(0,t.jsx)(i.A,{})]})}return(0,t.jsxs)("div",{className:"session-page",children:[(0,t.jsx)(o.A,{}),(0,t.jsxs)("main",{className:"session-container",children:[(0,t.jsxs)("div",{className:"session-card",children:[(0,t.jsxs)("div",{className:"session-header",children:[(0,t.jsx)("h1",{children:"Share this Session"}),(0,t.jsx)("p",{children:"Scan the QR code or share the link below. The session will expire automatically."})]}),(0,t.jsxs)("div",{className:"session-content",children:[(0,t.jsx)("div",{className:"qr-container",children:(null==w?void 0:w.qrCode)?(0,t.jsx)(l.default,{src:w.qrCode,alt:"QR Code",width:200,height:200,priority:!0}):(0,t.jsx)("div",{className:"qr-placeholder",children:"Generating QR..."})}),(0,t.jsxs)("div",{className:"session-info",children:[(0,t.jsxs)("div",{className:"time-remaining",children:[(0,t.jsx)(d.A,{size:20}),(0,t.jsx)("span",{children:"Time remaining: "}),(0,t.jsx)("span",{className:"countdown",children:(e=>{if(null==e)return"Calculating...";if(e<=0)return"00:00";let s=Math.floor(e/3600),n=Math.floor(e%3600/60);return"".concat(s>0?"".concat(s,":"):"").concat(n.toString().padStart(2,"0"),":").concat((e%60).toString().padStart(2,"0"))})(h)})]}),(0,t.jsxs)("div",{className:"session-url-container",children:[(0,t.jsx)("input",{type:"text",value:(null==w?void 0:w.downloadUrl)||"",readOnly:!0,className:"session-url"}),(0,t.jsxs)("button",{className:"copy-btn ".concat(v?"copied":""),onClick:()=>{if(!(null==w?void 0:w.downloadUrl))return;let e="".concat(window.location.origin).concat(w.downloadUrl);navigator.clipboard.writeText(e).then(()=>{g(!0),setTimeout(()=>g(!1),2e3)}).catch(e=>{console.error("Failed to copy text: ",e),alert("Failed to copy link to clipboard.")})},disabled:!(null==w?void 0:w.downloadUrl)||v,children:[v?(0,t.jsx)(u,{size:18}):(0,t.jsx)(x.A,{size:18}),v?"Copied!":"Copy"]})]}),(0,t.jsxs)("div",{className:"share-options",children:[(0,t.jsxs)("button",{className:"share-btn",children:[(0,t.jsx)(m,{size:18}),"Share via Email"]}),(0,t.jsxs)("button",{className:"cancel-btn",onClick:R,children:[(0,t.jsx)(p,{size:18}),"Cancel Session"]})]})]})]}),N&&(0,t.jsxs)("div",{className:"confirmation-toast",children:[(0,t.jsx)(u,{size:18}),"Session created! Share the link or QR code with recipients."]})]}),(0,t.jsxs)("div",{className:"session-details",children:[(0,t.jsx)("h2",{children:"Session Details"}),(0,t.jsxs)("div",{className:"details-grid",children:[(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("h3",{children:"Files Shared"}),(0,t.jsxs)("p",{children:[(null==w?void 0:w.fileCount)||1," file",(null==w?void 0:w.fileCount)!==1?"s":"",(null==w?void 0:w.totalSize)?" (".concat(null==(e=w.totalSize)||e<0?"N/A":0===e?"0 B":e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(2)," KB"):"".concat((e/1048576).toFixed(2)," MB"),")"):""]})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("h3",{children:"Created"}),(0,t.jsx)("p",{children:(null==w?void 0:w.createdAt)?new Date(w.createdAt).toLocaleString():"Just now"})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("h3",{children:"Expires"}),(0,t.jsx)("p",{children:(null==w?void 0:w.expiresAt)?new Date(w.expiresAt).toLocaleString():"Calculating..."})]}),(0,t.jsxs)("div",{className:"detail-item",children:[(0,t.jsx)("h3",{children:"Downloads"}),(0,t.jsxs)("p",{children:[(null==w?void 0:w.downloads)||0," of ",(null==w?void 0:w.maxDownloads)||"unlimited"]}),"            "]})]})]})]}),(0,t.jsx)(i.A,{})]})}}},e=>{e.O(0,[195,223,176,239,332,441,255,358],()=>e(e.s=8634)),_N_E=e.O()}]);